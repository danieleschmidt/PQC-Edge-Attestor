# PQC-Edge-Attestor Environment Configuration
# Copy this file to .env and modify values as needed

# =============================================================================
# Application Configuration
# =============================================================================
NODE_ENV=development
LOG_LEVEL=debug
PORT=3000

# =============================================================================
# Database Configuration
# =============================================================================
DATABASE_URL=postgresql://username:password@localhost:5432/pqc_attestor
DATABASE_MAX_CONNECTIONS=10
DATABASE_SSL=false

# Redis for caching and session management
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# =============================================================================
# Cryptographic Configuration
# =============================================================================
# PQC algorithm preferences (kyber1024, dilithium5, falcon1024)
PQC_KEM_ALGORITHM=kyber1024
PQC_SIGNATURE_ALGORITHM=dilithium5
PQC_SECURITY_LEVEL=5

# Enable hybrid classical + PQC mode during transition
PQC_HYBRID_MODE=true
CLASSICAL_KEM_ALGORITHM=ecdh_p384
CLASSICAL_SIGNATURE_ALGORITHM=ecdsa_p384

# Hardware security module configuration
HSM_ENABLED=false
HSM_PROVIDER=pkcs11
HSM_LIBRARY_PATH=/usr/lib/libpkcs11.so
HSM_TOKEN_LABEL=PQC-Attestor-HSM

# =============================================================================
# TPM Configuration
# =============================================================================
TPM_ENABLED=true
TPM_DEVICE=/dev/tpm0
TPM_SIMULATOR_HOST=127.0.0.1
TPM_SIMULATOR_PORT=2321

# PCR registers to use for attestation
TPM_PCR_FIRMWARE=0
TPM_PCR_CONFIG=1
TPM_PCR_RUNTIME=2
TPM_PCR_KEYS=3

# =============================================================================
# Device Configuration
# =============================================================================
DEVICE_TYPE=smart_meter
DEVICE_SERIAL=SM-001-DEV
DEVICE_MANUFACTURER=Terragon Labs
DEVICE_MODEL=PQC-SM-1000

# Hardware platform (stm32l5, nrf9160, cortex-m4)
HARDWARE_PLATFORM=stm32l5
HARDWARE_VERSION=1.0
FIRMWARE_VERSION=1.0.0

# =============================================================================
# Attestation Configuration
# =============================================================================
ATTESTATION_INTERVAL_MINUTES=60
ATTESTATION_ENABLED=true
CONTINUOUS_MONITORING=true
MEASUREMENT_LOG_MAX_ENTRIES=1000

# Backend attestation server
ATTESTATION_SERVER_URL=https://attestation-backend.example.com
ATTESTATION_SERVER_API_KEY=your-api-key-here
ATTESTATION_TIMEOUT_SECONDS=30

# =============================================================================
# Network Configuration
# =============================================================================
# MQTT broker for IoT communication
MQTT_BROKER_URL=mqtt://localhost:1883
MQTT_USERNAME=
MQTT_PASSWORD=
MQTT_CLIENT_ID=pqc-attestor-device
MQTT_TOPIC_PREFIX=pqc/attestation

# CoAP configuration for constrained networks
COAP_ENABLED=false
COAP_PORT=5683
COAP_MULTICAST_ADDRESS=224.0.1.187

# TLS configuration
TLS_CERT_PATH=/etc/ssl/certs/device.crt
TLS_KEY_PATH=/etc/ssl/private/device.key
TLS_CA_PATH=/etc/ssl/certs/ca.crt
TLS_VERIFY_PEER=true

# =============================================================================
# OTA Update Configuration
# =============================================================================
OTA_ENABLED=true
OTA_SERVER_URL=https://ota-server.example.com
OTA_CHECK_INTERVAL_HOURS=24
OTA_AUTO_INSTALL=false
OTA_SIGNATURE_ALGORITHM=falcon1024
OTA_ENCRYPTION_ALGORITHM=kyber1024

# Firmware storage
FIRMWARE_STORAGE_PATH=/var/lib/pqc-attestor/firmware
FIRMWARE_BACKUP_COUNT=3
FIRMWARE_ROLLBACK_ENABLED=true

# =============================================================================
# Security Configuration
# =============================================================================
# API security
JWT_SECRET=your-jwt-secret-256-bits-minimum
JWT_EXPIRATION=24h
API_RATE_LIMIT=100
API_RATE_LIMIT_WINDOW=15

# CORS configuration
CORS_ORIGIN=https://dashboard.example.com
CORS_CREDENTIALS=true

# Security headers
SECURITY_HSTS_ENABLED=true
SECURITY_CSP_ENABLED=true
SECURITY_NOSNIFF_ENABLED=true

# =============================================================================
# Monitoring and Logging
# =============================================================================
# Prometheus metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Structured logging
LOG_FORMAT=json
LOG_FILE=/var/log/pqc-attestor/app.log
LOG_MAX_SIZE=100MB
LOG_MAX_FILES=10

# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=8080
HEALTH_CHECK_PATH=/health

# =============================================================================
# Development and Testing
# =============================================================================
# Enable debug features (never use in production)
DEBUG_ENABLED=true
DEBUG_CRYPTO_TIMING=false
DEBUG_TPM_SIMULATION=true
DEBUG_MOCK_HARDWARE=false

# Testing configuration
TEST_DATABASE_URL=postgresql://test:test@localhost:5432/pqc_attestor_test
TEST_TPM_SIMULATOR=true
TEST_MOCK_HSM=true
TEST_PARALLEL_EXECUTION=true

# Performance testing
BENCHMARK_ENABLED=false
BENCHMARK_ITERATIONS=1000
BENCHMARK_OUTPUT_FILE=/tmp/benchmark_results.json

# =============================================================================
# Deployment Configuration
# =============================================================================
# Container configuration
CONTAINER_NAME=pqc-edge-attestor
CONTAINER_MEMORY_LIMIT=512MB
CONTAINER_CPU_LIMIT=1

# Cloud provider settings
CLOUD_PROVIDER=aws
CLOUD_REGION=us-east-1
CLOUD_INSTANCE_TYPE=t3.micro

# Kubernetes configuration
K8S_NAMESPACE=pqc-attestor
K8S_SERVICE_ACCOUNT=pqc-attestor-sa
K8S_REPLICAS=1

# =============================================================================
# Compliance and Audit
# =============================================================================
# Regulatory compliance
COMPLIANCE_NIST_ENABLED=true
COMPLIANCE_FIPS_ENABLED=false
COMPLIANCE_CC_EVALUATION=false

# Audit logging
AUDIT_ENABLED=true
AUDIT_LOG_FILE=/var/log/pqc-attestor/audit.log
AUDIT_SYSLOG_ENABLED=false
AUDIT_REMOTE_SERVER=

# Data retention
DATA_RETENTION_DAYS=365
LOG_RETENTION_DAYS=90
MEASUREMENT_RETENTION_DAYS=30

# =============================================================================
# External Services
# =============================================================================
# Certificate Authority
CA_SERVER_URL=https://ca.example.com
CA_API_KEY=your-ca-api-key
CA_CERTIFICATE_VALIDITY_DAYS=365

# Time synchronization
NTP_SERVERS=pool.ntp.org,time.google.com
TIME_SYNC_INTERVAL_HOURS=6

# Notification services
SLACK_WEBHOOK_URL=
EMAIL_SMTP_SERVER=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_USERNAME=
EMAIL_PASSWORD=

# =============================================================================
# Feature Flags
# =============================================================================
FEATURE_QUANTUM_SAFE_TLS=true
FEATURE_HYBRID_CRYPTO=true
FEATURE_REMOTE_ATTESTATION=true
FEATURE_OTA_UPDATES=true
FEATURE_CONTINUOUS_MONITORING=true
FEATURE_ANOMALY_DETECTION=false
FEATURE_ML_THREAT_ANALYSIS=false